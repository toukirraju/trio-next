{"version":3,"file":"Popover.jsx","sourceRoot":"","sources":["Popover.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from \"react\";\r\nimport {\r\n  useFloating,\r\n  autoUpdate,\r\n  offset,\r\n  flip,\r\n  shift,\r\n  useClick,\r\n  useDismiss,\r\n  useRole,\r\n  useInteractions,\r\n  useMergeRefs,\r\n  Placement,\r\n  FloatingPortal,\r\n  FloatingFocusManager,\r\n  useId,\r\n  FloatingArrow,\r\n  arrow,\r\n} from \"@floating-ui/react\";\r\n\r\ninterface PopoverOptions {\r\n  initialOpen?: boolean;\r\n  placement?: Placement;\r\n  modal?: boolean;\r\n  open?: boolean;\r\n  onOpenChange?: (open: boolean) => void;\r\n  arrowFill?: string;\r\n  indicatorArrow?: boolean;\r\n}\r\n\r\nexport function usePopover({\r\n  initialOpen = false,\r\n  placement = \"bottom\",\r\n  modal,\r\n  open: controlledOpen,\r\n  onOpenChange: setControlledOpen,\r\n  arrowFill,\r\n  indicatorArrow,\r\n}: PopoverOptions = {}) {\r\n  const arrowRef = React.useRef(null);\r\n  const [uncontrolledOpen, setUncontrolledOpen] = React.useState(initialOpen);\r\n  const [labelId, setLabelId] = React.useState<string | undefined>();\r\n  const [descriptionId, setDescriptionId] = React.useState<\r\n    string | undefined\r\n  >();\r\n\r\n  const open = controlledOpen ?? uncontrolledOpen;\r\n  const setOpen = setControlledOpen ?? setUncontrolledOpen;\r\n\r\n  const data = useFloating({\r\n    placement,\r\n    open,\r\n    onOpenChange: setOpen,\r\n    whileElementsMounted: autoUpdate,\r\n    middleware: [\r\n      offset(5),\r\n      flip({\r\n        crossAxis: placement.includes(\"-\"),\r\n        fallbackAxisSideDirection: \"end\",\r\n        padding: 5,\r\n      }),\r\n      shift({ padding: 5 }),\r\n      arrow({\r\n        element: arrowRef,\r\n      }),\r\n    ],\r\n  });\r\n\r\n  const context = data.context;\r\n\r\n  const click = useClick(context, {\r\n    enabled: controlledOpen == null,\r\n  });\r\n  const dismiss = useDismiss(context);\r\n  const role = useRole(context);\r\n\r\n  const interactions = useInteractions([click, dismiss, role]);\r\n\r\n  return React.useMemo(\r\n    () => ({\r\n      open,\r\n      setOpen,\r\n      ...interactions,\r\n      ...data,\r\n      modal,\r\n      labelId,\r\n      descriptionId,\r\n      setLabelId,\r\n      setDescriptionId,\r\n      arrowRef, // Make sure arrowRef is included in the returned object\r\n      arrowFill,\r\n      indicatorArrow,\r\n      onOpenChange: setOpen,\r\n      events: context.events,\r\n      dataRef: context.dataRef,\r\n      nodeId: context.nodeId,\r\n      floatingId: context.floatingId,\r\n    }),\r\n    [\r\n      open,\r\n      setOpen,\r\n      interactions,\r\n      data,\r\n      modal,\r\n      labelId,\r\n      descriptionId,\r\n      arrowFill,\r\n      indicatorArrow,\r\n    ]\r\n  );\r\n}\r\n\r\ntype ContextType =\r\n  | (ReturnType<typeof usePopover> & {\r\n      setLabelId: React.Dispatch<React.SetStateAction<string | undefined>>;\r\n      setDescriptionId: React.Dispatch<\r\n        React.SetStateAction<string | undefined>\r\n      >;\r\n    })\r\n  | null;\r\n\r\nconst PopoverContext = React.createContext<ContextType>(null);\r\n\r\nexport const usePopoverContext = () => {\r\n  const context = React.useContext(PopoverContext);\r\n\r\n  if (context == null) {\r\n    throw new Error(\"Popover components must be wrapped in <Popover />\");\r\n  }\r\n\r\n  return context;\r\n};\r\n\r\nexport function Popover({\r\n  children,\r\n  modal = false,\r\n  ...restOptions\r\n}: {\r\n  children: React.ReactNode;\r\n} & PopoverOptions) {\r\n  // This can accept any props as options, e.g. `placement`,\r\n  // or other positioning options.\r\n  const popover = usePopover({ modal, ...restOptions });\r\n  return (\r\n    <PopoverContext.Provider value={popover}>\r\n      {children}\r\n    </PopoverContext.Provider>\r\n  );\r\n}\r\n\r\ninterface PopoverTriggerProps {\r\n  children: React.ReactNode;\r\n  asChild?: boolean;\r\n}\r\n\r\nexport const PopoverTrigger = React.forwardRef<\r\n  HTMLElement,\r\n  React.HTMLProps<HTMLElement> & PopoverTriggerProps\r\n>(function PopoverTrigger({ children, asChild = false, ...props }, propRef) {\r\n  const context = usePopoverContext();\r\n  const childrenRef = (children as any).ref;\r\n  const ref = useMergeRefs([context.refs.setReference, propRef, childrenRef]);\r\n\r\n  // `asChild` allows the user to pass any element as the anchor\r\n  if (asChild && React.isValidElement(children)) {\r\n    return React.cloneElement(\r\n      children,\r\n      context.getReferenceProps({\r\n        ref,\r\n        ...props,\r\n        ...children.props,\r\n        \"data-state\": context.open ? \"open\" : \"closed\",\r\n      })\r\n    );\r\n  }\r\n\r\n  return (\r\n    <button\r\n      ref={ref}\r\n      type=\"button\"\r\n      // The user can style the trigger based on the state\r\n      data-state={context.open ? \"open\" : \"closed\"}\r\n      {...context.getReferenceProps(props)}\r\n    >\r\n      {children}\r\n    </button>\r\n  );\r\n});\r\n\r\nexport const PopoverContent = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLProps<HTMLDivElement>\r\n>(function PopoverContent({ style, ...props }, propRef) {\r\n  const {\r\n    context: floatingContext,\r\n    arrowRef,\r\n    arrowFill,\r\n    indicatorArrow,\r\n    ...context\r\n  } = usePopoverContext();\r\n  const ref = useMergeRefs([context.refs.setFloating, propRef]);\r\n\r\n  if (!floatingContext.open) return null;\r\n\r\n  return (\r\n    <FloatingPortal>\r\n      <FloatingFocusManager context={floatingContext} modal={context.modal}>\r\n        <div\r\n          ref={ref}\r\n          style={{ ...context.floatingStyles, ...style }}\r\n          aria-labelledby={context.labelId}\r\n          aria-describedby={context.descriptionId}\r\n          {...context.getFloatingProps(props)}\r\n        >\r\n          {\r\n            // If the user wants to show the arrow, we render it here\r\n            indicatorArrow && (\r\n              <FloatingArrow\r\n                ref={arrowRef}\r\n                context={context}\r\n                fill={arrowFill || \"white\"}\r\n              />\r\n            )\r\n          }\r\n          {props.children}\r\n        </div>\r\n      </FloatingFocusManager>\r\n    </FloatingPortal>\r\n  );\r\n});\r\n\r\nexport const PopoverHeading = React.forwardRef<\r\n  HTMLHeadingElement,\r\n  React.HTMLProps<HTMLHeadingElement>\r\n>(function PopoverHeading(props, ref) {\r\n  const { setLabelId } = usePopoverContext();\r\n  const id = useId();\r\n\r\n  // Only sets `aria-labelledby` on the Popover root element\r\n  // if this component is mounted inside it.\r\n  React.useLayoutEffect(() => {\r\n    setLabelId(id);\r\n    return () => setLabelId(undefined);\r\n  }, [id, setLabelId]);\r\n\r\n  return (\r\n    <h2 {...props} ref={ref} id={id}>\r\n      {props.children}\r\n    </h2>\r\n  );\r\n});\r\n\r\nexport const PopoverDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLProps<HTMLParagraphElement>\r\n>(function PopoverDescription(props, ref) {\r\n  const { setDescriptionId } = usePopoverContext();\r\n  const id = useId();\r\n\r\n  // Only sets `aria-describedby` on the Popover root element\r\n  // if this component is mounted inside it.\r\n  React.useLayoutEffect(() => {\r\n    setDescriptionId(id);\r\n    return () => setDescriptionId(undefined);\r\n  }, [id, setDescriptionId]);\r\n\r\n  return <p {...props} ref={ref} id={id} />;\r\n});\r\n\r\nexport const PopoverClose = React.forwardRef<\r\n  HTMLButtonElement,\r\n  React.ButtonHTMLAttributes<HTMLButtonElement>\r\n>(function PopoverClose(props, ref) {\r\n  const { setOpen } = usePopoverContext();\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      ref={ref}\r\n      {...props}\r\n      onClick={(event) => {\r\n        props.onClick?.(event);\r\n        setOpen(false);\r\n      }}\r\n    />\r\n  );\r\n});\r\n"]}